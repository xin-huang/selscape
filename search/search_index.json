{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Selscape","text":"<p><code>selscape</code> is a flexible workflow framework designed to study patterns of natural selection across different species. It integrates different detection methods such as betascan to detect long-term balancing selection, selscan for positive selection and dadi-cli for distribution of fitness effects (DFE). In addition, to understand biological functions of selected candidates, annotation with ANNOVAR and functional enrichment with Gowinda are performed.</p>"},{"location":"#key-features","title":"Key Features","text":"<p><code>selscape</code> is designed for flexibility and supports:</p> Feature Description Multi-species support Configurable for any species through YAML files Selection methods betascan, selscan, dadi-cli integration Flexible data input Customizable VCF file naming and chromosome schemes Functional analysis Gene annotation and GO enrichment Scalable execution Snakemake workflow with cluster support"},{"location":"#requirements","title":"Requirements","text":"<p><code>selscape</code> works on Linux operating systems with the following dependencies:   - bcftools=1.21   - bedtools=2.31.1   - bioconductor-biomart=2.62.0   - cyvcf2=0.31.0   - dadi=2.3.0   - dadi-cli=0.9.1   - matplotlib=3.9.4   - nlopt=2.7.1   - numpy=1.26.4   - pandas=2.2.3   - pip=25.0.1   - plink=1.90b6.21   - pyliftover=0.4.1   - pysam=0.23.0   - python=3.11.13   - r-base=4.4.3   - r-ggplot2=3.5.2   - r-qqman=0.1.9   - r-readr=2.1.5   - scipy=1.13.1   - snakemake=7.32.4</p>"},{"location":"#installation","title":"Installation","text":"<p>Users can install <code>selscape</code> using the following steps:</p> <ol> <li> <p>Install Mambaforge (if not already installed):    Mambaforge installation guide</p> </li> <li> <p>Clone the repository:</p> </li> </ol> <pre><code>git clone https://github.com/xin-huang/selscape.git\ncd selscape\n</code></pre> <ol> <li>Create and activate the environment:</li> </ol> <pre><code>mamba env create -f workflow/envs/env.yaml\nmmaba activate selscape\n</code></pre> <p>Users should manually download ANNOVAR and place it in <code>resources/tools</code>. An institutional email adress is required for registration.</p>"},{"location":"#help","title":"Help","text":"<p>For detailed configuration and usage instructions, see the documentation. If you need further help, such as reporting a bug or suggesting a feature, please open an issue.</p>"},{"location":"userguide/configuration/","title":"Configuration","text":""},{"location":"userguide/configuration/#essential-setup-mainyaml","title":"Essential Setup (main.yaml)","text":"<p>Most users only need to modify these core settings:</p>"},{"location":"userguide/configuration/#species-and-populations-human-example","title":"Species and Populations (Human Example)","text":"<pre><code># Main configuration for species and data paths\n\ntesting_mode:  true  # Set to false for production analysis\n\n# Species identification\nspecies: \"Human\"\n\n# Populations to analyze\npopulations:\n  - YRI\n  - CHS\n\n# Data location and file naming\ndata:\n  # Start with a small subset for testing \n  chromosomes:\n     - 21\n     - 22\n\n  # Tell selscape how your VCF files are named\n  vcf_files:\n    base_path: \"resources/data\"\n    file_prefix: \"\"\n    file_suffix: \".vcf.gz\"\n    chr_name: \"{ppl}.chr{i}\"  # {ppl} = population, {i} = chromosome\n\n  # Path to your sample metadata file\n  metadata: \"resources/data/1KG_metadata.txt\"\n\n# Reference genome\nreference:\n  species_code: \"hg38\"\n  human_code: \"hg38\"\n</code></pre>"},{"location":"userguide/configuration/#method-parameters","title":"Method Parameters","text":"<p>Betascan (Balancing Selection) ```yaml</p> <p>core_frequencies:   - 0.15  # Most sensitive for detecting balancing selection</p> <p>frequency_filters:   min_af: 0.05  # Remove rare variants   max_af: 0.95  # Remove nearly fixed variants</p> <p>folding:   use_folded: true  # Use if you don't have ancestral states   <code>**Selscan (Positive Selection)**</code>yaml data_type:   unphased: true  # Set to false if you have phased data</p> <p>statistics:   within_population: [ihs, nsl]   cross_population: [xpehh, xpnsl]</p> <p>frequency_filters:   maf_thresholds: [0.05]  # Minor allele frequency cutoff   ```</p>"},{"location":"userguide/configuration/#advanced-configuration","title":"Advanced Configuration","text":"<p>main.yaml Parameters</p> Parameter Type Description Default testing_mode boolean Use example data for testing false species string Species identifier for outputs \"Human\" populations list Population code to analyze [\"YRI\", \"CHS\"] data.chromosomes list Chromosomes to include [21, 22] data.vcf_files.base_path string VCF file directory \"resources/data\" data.vcf_files.chr_name string Chromosome naming pattern \"{ppl}.chr{i}\" reference.species_code string Reference genome build \"hg38\" data.metadata string Sample metadata file path \"resources/data/1KG_metadata.txt\" data.vcf_files.file_prefix string VCF filename prefix \"\" data.vcf_files.file_suffix string VCF filename suffix \".vcf.gz\" data_sources dict Data source configurations see config reference.annotation_reference string Reference genome for annotation databases \"hg38\" <p>betascan.yaml Parameters |       Parameter         |Type                        |Description                     | Default        |  |----------------|-------------------------------|-----------------------------|-----------------------------|  |core_frequencies|list           |Core allele frequencies for B1           | [0.15]|  |frequency_filters.min_af         |float          |Minimum allele frequency          |0.05 |  |frequency_filters.max_af          |float|Maximum allele frequency|0.95 |  |folding.use_folded          |boolean|Use folded SFS|true |  |thresholds.top_percent         |float|Top % for candidates|0.0005 |  |quality_control.hwe_pvalue|float|Hardy-Weinberg p-value threshold|0.001| |quality_control.mask_repeats|boolean|Exclude repetitive regions|true|</p> <p>selscan.yaml Parameters |       Parameter         |Type                        |Description                     | Default        |  |----------------|-------------------------------|-----------------------------|-----------------------------|  |data_type.unphased|boolean            |Handle unphased data           | true|  |statistics.within_population         |list    |      Within-pop statistics |[ihs, nsl] |  |statistics.cross_population          |list|Cross-pop statistics|[xpehh, xpnsl] |  |frequency_filters.maf_thresholds          |list|MAF cutoffs|[0.05] |</p> <p>dadi-cli.yaml Parameters |       Parameter         |Type                        |Description                     | Default        |  |----------------|-------------------------------|-----------------------------|-----------------------------|  |flags.ratio|float           |Transition/transversion ratio          | 2.31|  |flags.optimizations        |integer|Number of optimization runs           | 50|  |grid_size.inference         |string|Grid size for inference| \"300 400 500\"|  |gamma_pts       |integer|Gamma integration points| 2000|  |grid_size.cache|string|Grid size for caching|\"800 1000 1200\"| |flags.bootstrap_replicates|integer|Bootstrap replicates|100| |flags.chunk_size|integer|Chunk size for bootstrap|1000000|</p> <p>annovar.yaml Parameters |Parameter|Type|Description|Default| |----------------|-------------------------------|-----------------------------|-----------------------------|  |species.{species}.genome_build|string|Reference genome build|\"hg38\"| |settings.threads|integer|Annotation threads|8|</p> <p>Please check Snakemake Configuration documentation for additional information.</p>"},{"location":"userguide/output/","title":"Output","text":""},{"location":"userguide/output/#betascan-results-balancing-selection","title":"Betascan Results (Balancing Selection)","text":"<p>Results are saved in <code>results/plots/betascan/Human/YRI/m_0.15/YRI.b1.top.0.0005.candidates.scores</code>.</p> <pre><code>SNP     CHR     BP      B1\n22:22350476     22      22350476        29.950265\n22:22350435     22      22350435        29.8842\n22:22350418     22      22350418        29.332644\n22:22350419     22      22350419        29.332644\n22:22350497     22      22350497        29.327195\n</code></pre> column Description SNP SNP identifier in format chromosome:position CHR Chromosome number BP Base pair position B1 Beta1 statistic for balancing selection <p>Higher B1 values suggests stronger evidence for balancing selection of loci where multiple alleles are maintained in the population over long periods.</p> <p></p>"},{"location":"userguide/output/#selscan-results-positive-selection","title":"Selscan Results (Positive Selection)","text":"<p>Results are saved in <code>results/plots/selscan/Human/1pop/YRI/nsl_0.05/YRI.normalized.nsl.top.0.0005.candidates.scores</code>.</p> <pre><code>SNP     CHR     BP      normalized_nsl  abs_normalized_nsl\n21:27635622     21      27635622        4.98329 4.98329\n22:19879946     22      19879946        4.5454  4.5454\n21:29707889     21      29707889        4.54516 4.54516\n21:27617315     21      27617315        4.37302 4.37302\n21:27642578     21      27642578        4.33443 4.33443\n</code></pre> column Description SNP SNP identifier in format chromosome:position CHR Chromosome number BP Base pair position normalized_{method} Normalized selection statistic (iHS, nSL, XP-EHH, XP-nSL) <p>High scores indicate recent positive selection where beneficial alleles rapidly increased in frequency. With iHS, nSL statistics, positive values means selection favoring the derived allele, while negative values indicates that selection favors the  ancestral allele. With cross selection statistisc (XP-EHH, XP-nSL), positive values show selection in the population 1 (first population listed). Negative values suggest selection in population 2 (second population listed)</p> <p></p>"},{"location":"userguide/output/#selection-candidates-annotation","title":"Selection Candidates Annotation","text":"<p>Selscan Example</p> <p>Results are stored in <code>results/plots/selscan/Human/1pop/YRI/nsl_0.05/YRI.normalized.nsl.top.0.0005.annotated.candidates</code>.</p> <pre><code>Chr     Start   End     Ref     Alt     Func.refGene    Gene.refGene    GeneDetail.refGene      ExonicFunc.refGene      AAChange.refGene        normalized_nsl\n21      19259240        19259240        A       C       intergenic      MIR548XHG;LINC01683     dist=499428;dist=634039 .       .       3.95068\n21      19261015        19261015        A       G       intergenic      MIR548XHG;LINC01683     dist=501203;dist=632264 .       .       4.01447\n21      19267995        19267995        T       C       intergenic      MIR548XHG;LINC01683     dist=508183;dist=625284 .       .       4.01979\n21      19269299        19269299        T       G       intergenic      MIR548XHG;LINC01683     dist=509487;dist=623980 .       .       4.11579\n21      26270854        26270854        G       T       intergenic      APP;CYYR1-AS1   dist=99726;dist=122781  .       .       4.05708\n</code></pre> <p>Betascan candidate results have the same format, except the last column is replaced with B1 score.</p> column Description Chr Chromosome Start Start Position of SNP window End End position of SNP window Ref Reference Allele Alt Alternative Allele Func.refGene Functional annotation (exonic, intronic, etc.) Gene.refGene Gene symbol ExonicFunc.refGene Exonic function (synonymous, nonsynonymous, etc.) AAChange.refGene Amino acid change score Selection statistic value"},{"location":"userguide/output/#dadi-cli-results-dfe","title":"Dadi-cli Results (DFE)","text":"<p>Distribution of Fitness</p> <p>Baboon Example (placeholder)</p> <pre><code># Log(likelihood)       log_mu  log_sigma       misid   theta\n-1583.6419711050235     0.0001  10.036936601427616      0.03935425742951182     3146.354810257352\n-1583.641978040827      0.0001  10.037430294509049      0.039352517953454194    3146.354810257352\n-1583.6419830604987     0.0001  10.037590533056404      0.03933425868201494     3146.354810257352\n-1583.6420065768962     0.0001  10.037898514671456      0.039345846769698795    3146.354810257352\n-1583.642012206451      0.0001  10.036589176494077      0.039348107346255747    3146.354810257352\n</code></pre> column Description Log(likelihood) mathematical measure how well model fits data log_mu Parameter describing the center of the lognormal distribution of selection coefficients log_sigma Parameter describing the spread of the lognormal distribution misid Proportion of misidentified ancestral states in the data theta Population-scaled mutation rate (4N\u2091\u03bc) <p>Demographic Model</p> <p>Baboon Example (placeholder)</p> <pre><code># Log(likelihood)       nu      T       misid   theta\n-511.2556676138038      0.3072571458169096      0.029684712654180687    0.1867057098794246      15297.736007242134\n-511.26099404545494     0.30821618471879975     0.029869554926965972    0.1866371110098524      15299.330420308932\n-511.2617059355539      0.3046331410365202      0.02923435458096174     0.18693420973895863     15297.05292795244\n-511.2556676138038      0.3072571458169096      0.029684712654180687    0.1867057098794246      15297.736007242134\n-511.26099404545494     0.30821618471879975     0.029869554926965972    0.1866371110098524      15299.330420308932\n</code></pre> column Description Log(likelihood) mathematical measure how well model fits data nu ratio of current population size to ancestral size T (time) time since population size changed, meassured in 2N generation misid error rate of data, accounting for misidentified ancestral alleles or seq error theta population scaled mutation rate"},{"location":"userguide/output/#gowinda-enrichment-results","title":"Gowinda Enrichment Results","text":"<p>Results are saved in <code>results/functional_analysis_gowinda/Human/1pop/YRI/nsl_0.05/YRI.nsl_0.05.top.0.0005.gowinda.enrichment.tsv</code></p> <pre><code>GO:0006979  0.072   2   0.0015570000    0.1680687353    2   7   161 involved_in response to oxidative stress    txnrd2,comt\nGO:0042415  0.007   1   0.0066270000    0.1680687353    1   1   10  involved_in norepinephrine metabolic process    comt\nGO:0042417  0.007   1   0.0066270000    0.1680687353    1   1   18  involved_in dopamine metabolic process  comt\nGO:0002001  0.007   1   0.0066270000    0.1680687353    1   1   4   acts_upstream_of_or_within renin secretion into blood stream    comt\nGO:0048243  0.007   1   0.0066270000    0.1680687353    1   1   1   acts_upstream_of_or_within norepinephrine secretion comt\n</code></pre> column Description GO_ID Gene Ontology term avg_genes_sim Average genes in simulations genes_found Genes found in candidates p_value Uncorrected p-value p_adjusted FDR-corrected p-value genes_uniq Unique genes in term genes_max Maximum genes possible genes_total Total genes in background description GO term description gene_list Comma-separated candidate genes <p></p> <p>More information about gowinda can be found here.</p>"},{"location":"userguide/usage/","title":"Usage","text":"<p>Selscape provides two modes: testing mode for learning the workflow with example data, and main analysis workflow for analyzing your own datasets.</p>"},{"location":"userguide/usage/#testing-mode","title":"Testing Mode","text":"<p>1. Configure for Testing</p> <p>Ensure <code>testing_mode: true</code> in your main configuration:</p> <pre><code># config/main.yaml \ntesting_mode:  true\n</code></pre> <p>2. Run Test Analysis</p> <p>The repository includes small example datasets (YRI and CHS populations, chromosomes 21-22) in <code>examples/data/Human/</code>, so you can start testing immediately:</p> <pre><code># Local execution \nsnakemake --cores 1\n\n# HPC execution \nsnakemake --profile config/slurm/ --jobs 10\n</code></pre>"},{"location":"userguide/usage/#main-analysis-workflow","title":"Main Analysis Workflow","text":"<p>1. Prepare your Data Place your raw VCF files in the correct directory structure:</p> <pre><code>resources/data/{species}/raw/\n\u251c\u2500\u2500 chr1.vcf.gz\n\u251c\u2500\u2500 chr1.vcf.gz.tbi \n\u251c\u2500\u2500 chr2.vcf.gz \n\u251c\u2500\u2500 chr2.vcf.gz.tbi\n\u2514\u2500\u2500 ...\n</code></pre> <p>2. Configure for Main Workflow</p> <pre><code># config/main.yaml\ntesting_mode: false\n\nspecies: \"YourSpecies\"\n\npopulations:\n  - PopA\n  - PopB\n\ndata:\n  # Update paths to match your data structure\n  vcf_files:\n    base_path: \"resources/data\"\n    file_prefix: \"\"\n    file_suffix: \".vcf.gz\"\n    chr_name: \"chr{i}\"  # Adjust to match your naming\n\n  metadata: \"resources/data/YourSpecies_metadata.txt\"\n\n  chromosomes:\n    - 1\n    - 2\n    # ... add all chromosomes\n</code></pre> <p>3. Run Main  Analysis</p> <p>Run Analysis on HPC:</p> <pre><code>snakemake --profile config/slurm/ -j 30\n</code></pre> <p>Run Analysis locally:</p> <pre><code>snakemake -j 5\n</code></pre>"},{"location":"userguide/usage/#clean-restart","title":"Clean Restart","text":"<p>To start fresh (removes all previous results):</p> <pre><code>rm -rf resources/ results/ logs/\n</code></pre>"},{"location":"userguide/usage/#basic-options","title":"Basic Options","text":"Command Purpose -j 30 Use 30 parallel jobs --profile config/slurm/ Submit jobs to SLURM cluster -n Dry run (preview what will be executed) <p>For further information, please visit the Snakemake documentation website.</p>"}]}