{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"selscape","text":"<p><code>selscape</code> is a Snakemake workflow framework for studying genomic landscapes of natural selection across species. It integrates BCFtools and PLINK for variant processing and filtering, and runs selection scans with BetaScan, selscan, and scikit-allel to identify outlier regions across multiple statistics. It also uses dadi via dadi-cli to infer the distribution of fitness effects (DFE). Outlier regions are functionally annotated with ANNOVAR and assessed for Gene Ontology (GO) term enrichment using Gowinda.</p> <p></p>"},{"location":"#requirements","title":"Requirements","text":"<p><code>selscape</code> works on Linux operating systems with the following dependencies:</p> <ul> <li>bcftools=1.21</li> <li>bedtools=2.31.1</li> <li>cyvcf2=0.31.0</li> <li>dadi=2.4.3</li> <li>dadi-cli=0.9.13</li> <li>matplotlib=3.9.4</li> <li>nlopt=2.10.0</li> <li>numpy=1.26.4</li> <li>openjdk=25.0.1</li> <li>pandas=2.2.3</li> <li>pip=25.0.1</li> <li>plink=1.90b6.21</li> <li>pyliftover=0.4.1</li> <li>pydantic=2.5.0</li> <li>pysam=0.23.0</li> <li>python=3.11.13</li> <li>r-base=4.4.3</li> <li>r-data.table=1.17.8</li> <li>r-dt=0.33</li> <li>r-ggplot2=3.5.2</li> <li>r-htmlwidgets=1.6.4</li> <li>r-qqman=0.1.9</li> <li>r-readr=2.1.5</li> <li>scikit-allel=1.3.7</li> <li>scipy=1.13.1</li> <li>snakemake=7.32.4</li> </ul>"},{"location":"#installation","title":"Installation","text":"<p>Users can first install mamba, and then install <code>selscape</code> using the following commands:</p> <pre><code>git clone https://github.com/xin-huang/selscape\ncd selscape\nmamba env create -f workflow/envs/env.yaml\nmamba activate selscape-test\n</code></pre> <p>In addition, users must manually download ANNOVAR and place the downloaded <code>annovar/</code> directory under <code>resources/tools/</code>.</p>"},{"location":"#help","title":"Help","text":"<p>For detailed configuration and usage instructions, see the documentation. If you need further help, such as reporting a bug or suggesting a feature, please open an issue.</p>"},{"location":"userguide/configuration/","title":"Configuration","text":"<p>Selscape uses multiple YAML configuration files to control different aspects of the analysis:</p> File Purpose <code>config/main.yaml</code> Core settings (species, populations, data paths) <code>config/selscan.yaml</code> selscan parameters <code>config/betascan.yaml</code> BetaScan parameters <code>config/scikit-allel.yaml</code> scikit-allel parameters <code>config/dadi-cli.yaml</code> dadi-cli parameters <code>config/slurm/config.yaml</code> HPC cluster settings (optional)"},{"location":"userguide/configuration/#mainyaml","title":"main.yaml","text":""},{"location":"userguide/configuration/#example","title":"Example","text":"<pre><code># Species identification\nspecies: \"Human\"\ntax_id: 9606\nref_genome: \"hg38\"\nploidy: 2\n\n# Populations to analyze\npopulations:\n  - YRI\n  - CHS\n\n# VCF file configuration\ndata_folder: \"examples/data/Human/raw\"\nvcf_prefix: \"full_chr\"\nvcf_suffix: \".vcf.gz\"\n# Files should be named: {vcf_prefix}{chromosome}{vcf_suffix}\n# Example: full_chr21.vcf.gz\n\nmetadata: \"examples/data/Human/metadata/example_metadata.txt\"\n\n# Chromosomes to analyze\nchromosomes:\n  - 20\n  - 21\n\n# Ancestral alleles for polarization (optional but recommended)\nanc_alleles:\n  path: \"examples/data/Human/ancestral_alleles/homo_sapiens_ancestor_GRCh38\"\n  prefix: \"homo_sapiens_ancestor_chr\"\n  # Files: {prefix}{chromosome}.bed.gz\n\n# Annotation files\ngenome_annotation: \"examples/data/Human/annotation/Human.gtf.gz\"\ngene2go: \"examples/data/Human/annotation/gene2go.gz\"\n\n# Quality control\nhwe_pvalue: 0.001  # Hardy-Weinberg equilibrium threshold\n\n# Repeat regions (optional)\nrmsk: \"examples/data/Human/repeats/hg38.rmsk.autosomes.bed\"\nseg_dup: \"examples/data/Human/repeats/hg38.seg.dups.autosomes.bed\"\nsim_rep: \"examples/data/Human/repeats/hg38.simple.repeats.autosomes.bed\"\n\n# Method configuration files\nselscan_config: \"config/selscan.yaml\"\nbetascan_config: \"config/betascan.yaml\"\ndadi_config: \"config/dadi-cli.yaml\"\nscikit_allel_config: \"config/scikit-allel.yaml\"\n</code></pre>"},{"location":"userguide/configuration/#parameters","title":"Parameters","text":"Parameter Type Description Required species string Species name Y tax_id integer NCBI taxonomy ID Y ref_genome string Reference genome build Y anc_alleles.path string Base folder for ancestral allele information N anc_alleles.prefix string Ancestral allele information filename prefix N genome_annotation string Path to genome annotation GTF file Y gene2go string Path to gene2go mapping file Y hwe_pvalue float Hardy-Weinberg equilibrium p-value threshold Y hwe_pvalue float Hardy-Weinberg equilibrium p-value threshold Y rmsk string Path to repeat masker BED file N seg_dup string Path to segmental duplications BED file N sim_rep string Path to simple repeats BED file N ploidy integer Organism ploidy Y populations list List of population IDs to analyze Y data_folder string Base folder for input VCF files Y vcf_prefix string VCF filename prefix Y vcf_suffix string VCF filename suffix Y metadata string Path to sample metadata file Y chromosomes list List of chromosomes to analyze Y betascan_config string Path to BetaScan configuration file Y selscan_config string Path to selscan configuration file Y dadi_config string Path to dadi-cli configuration file Y scikit_allel_config string Path to scikit-allel configuration file Y"},{"location":"userguide/configuration/#betascanyaml","title":"betascan.yaml","text":""},{"location":"userguide/configuration/#example_1","title":"Example","text":"<pre><code># Data type\nunfolded: True  # Use polarized data (requires ancestral alleles)\n\n# Core allele frequency parameter\ncore_frq: 0.15\n\n# Allele frequency filters\nmin_af: 0.05  # Minimum allele frequency\nmax_af: 0.95  # Maximum allele frequency\n\n# Statistical thresholds\ntop_proportion: 0.0005  # Top proportion for outlier identification\n\n# Manhattan plot settings\nmanhattan_plot_width: 640\nmanhattan_plot_height: 240\nmanhattan_plot_color1: \"#56B4E9\"\nmanhattan_plot_color2: \"#F0E442\"\n</code></pre>"},{"location":"userguide/configuration/#parameters_1","title":"Parameters","text":"Parameter Type Description Required unfolded boolean Use polarized/unfolded allele frequency spectrum Y core_frq float Core allele frequency parameter Y min_af float Minimum allele frequency Y max_af float Maximum allele frequency Y top_proportion float Top proportion for outlier identification Y"},{"location":"userguide/configuration/#selscanyaml","title":"selscan.yaml","text":""},{"location":"userguide/configuration/#example_2","title":"Example","text":"<pre><code># Data type\nunphased: true  # Set to false if you have phased data\n\n# Within-population statistics\nwp_stats:\n  - ihs   \n  - nsl    \n\n# Cross-population statistics  \nxp_stats:\n  - xpehh  \n  - xpnsl\n\n# Minor allele frequency threshold\nmaf: 0.05\n\n# Statistical thresholds\ntop_proportion: 0.0005\n\n# Manhattan plot settings\nmanhattan_plot_width: 640\nmanhattan_plot_height: 240\nmanhattan_plot_color1: \"#56B4E9\"\nmanhattan_plot_color2: \"#F0E442\"\n</code></pre>"},{"location":"userguide/configuration/#parameters_2","title":"Parameters","text":"Parameter Type Description Required unphased boolean Use unphased (true) or phased (false) data Y wp_stats list Within-population statistics to compute Y xp_stats list Cross-population statistics to compute Y maf float Minor allele frequency threshold Y top_proportion float Top proportion for outlier identification Y"},{"location":"userguide/configuration/#scikit-allelyaml","title":"scikit-allel.yaml","text":""},{"location":"userguide/configuration/#example_3","title":"Example","text":"<pre><code># Within-population statistics\nwp_stats:\n  - windowed_tajima_d   \n  - moving_tajima_d  \n\n# Windowed approach (base pair windows)\nwindowed_window_sizes: [100_000]\nwindowed_step_size_ratios: [1]  # 1 = non-overlapping windows\n\n# Moving approach (SNP windows)\nmoving_window_sizes: [100]\nmoving_step_size_ratios: [1]\n\n# Cross-population statistics \nxp_stats:\n  - delta_moving_tajima_d\n\n# XP moving approach (SNP windows)\ndelta_moving_window_sizes: [100]\ndelta_moving_step_size_ratios: [1]\n\n# Statistical thresholds\ntop_proportion: 0.05\n\n# Manhattan plot settings\nmanhattan_plot_width: 640\nmanhattan_plot_height: 240\nmanhattan_plot_color1: \"#56B4E9\"\nmanhattan_plot_color2: \"#F0E442\"\n</code></pre>"},{"location":"userguide/configuration/#parameters_3","title":"Parameters","text":"Parameter Type Description Required wp_stats list Within-population statistics to compute Y xp_stats list Cross-population statistics to compute Y wtjd_window_sizes list Window sizes in base pairs for windowed tajima's d (wtjd) statistic Y wtjd_step_size_ratios list Step size as fraction of window in base pair for wtjd statistic Y mtjd_window_sizes list Window sizes in SNPs for moving tajima's d (mtjd) statistic Y mtjd_step_size_ratios list Step size as fraction of window in SNPs for mtjd statistic Y dtjd_moving_window_sizes list Window sizes in SNPs for xp moving delta tajima's d (dtjd) statistic Y dtjd_moving_step_size_ratios list Step size as fraction of window in SNPs for cross population dtjd statistic Y top_proportion float Top proportion for outlier identification Y"},{"location":"userguide/configuration/#dadi-cliyaml","title":"dadi-cli.yaml","text":""},{"location":"userguide/configuration/#example_4","title":"Example","text":"<pre><code># Data type\nunfolded: True\n\n# Demographic models\ndemog_1d: two_epoch\ndemog_1d_p0: \"0.5 5 0.5\"\ndemog_1d_ub: \"10 10 1\"\ndemog_1d_lb: \"10e-5 10e-5 0\"\n\n# DFE models\ndfe_1d: lognormal\ndfe_1d_p0: \"5 5 0.5\"\ndfe_1d_ub: \"100 1000 1\"\ndfe_1d_lb: \"10e-5 10e-5 0\"\n\n# Grid sizes\ndm_grid_size: \"300 400 500\"\ndfe_grid_size: \"300 400 500\"\n\n# Gamma points for generating caches\ngamma_pts: 100\n\n# Ratio of non-synonymous/synonymous mutation rates\nratio: 2.31\n\n# Number of optimization runs\noptimizations: 50\n\n# Bootstrap parameters\nbootstrap_replicates: 100\nchunk_size: 1000000\n\n# Frequency spectrum flags\nmask_singletons: false\n</code></pre>"},{"location":"userguide/configuration/#parameters_4","title":"Parameters","text":"Parameter Type Description Required unfolded boolean Use polarized/unfolded allele frequency spectrum Y demog_1d string 1D demographic model name Y demog_1d_p0 string Initial parameters for 1D demographic model Y demog_1d_ub string Upper bounds for 1D demographic model parameters Y demog_1d_lb string Lower bounds for 1D demographic model parameters Y dfe_1d string 1D DFE model name Y dfe_1d_p0 string Initial parameters for 1D DFE model Y dfe_1d_ub string Upper bounds for 1D DFE model parameters Y dfe_1d_lb string Lower bounds for 1D DFE model parameters Y dm_grid_size string Grid sizes for demographic inference Y dfe_grid_size string Grid for DFE inference Y gamma_pts integer Number of gamma points for cache generation Y ratio float Ratio of non-synonymous to synonymous mutation rates Y optimizations integer Number of optimization runs Y bootstrap_replicates integer Number of bootstrap replicates Y chunk_size integer Chunk size for bootstrapping Y mask_singletons boolean Whether to mask singleton variants Y"},{"location":"userguide/configuration/#important-notes","title":"Important Notes","text":"<ol> <li> <p>Ancestral Alleles: If <code>anc_alleles</code> is not provided, polarization-dependent analyses (selscan, betascan with unfolded=True, dadi with unfolded=True) will not run.</p> </li> <li> <p>VCF File Naming: VCF files must follow the pattern: <code>{data_folder}/{vcf_prefix}{chromosome}{vcf_suffix}</code></p> </li> <li> <p>Example with <code>vcf_prefix: \"full_chr\"</code>: <code>examples/data/Human/raw/full_chr21.vcf.gz</code></p> </li> <li>Example with <code>vcf_prefix: \"chr\"</code>: <code>resources/data/chr21.vcf.gz</code></li> <li> <p>Example with <code>vcf_prefix: \"\"</code>: <code>resources/data/21.vcf.gz</code></p> </li> <li> <p>Metadata Format: Tab-separated file with columns: <code>Sample</code> and <code>Population</code></p> </li> <li> <p>Repeat Masking: Optional but recommended. Set to empty string or null to disable.</p> </li> <li> <p>Step Size Ratios: Values from 0 to 1 represent the fraction of window size to step. </p> </li> <li> <p>Example: window_size=100, step_ratio=0.1 \u2192 step_size=10</p> </li> </ol> <p>Please check Snakemake Configuration documentation for additional information.</p>"},{"location":"userguide/output/","title":"Output","text":""},{"location":"userguide/output/#overview","title":"Overview","text":"<p><code>selscape</code> organizes results by analysis type and population:</p> <pre><code>results/\n\u251c\u2500\u2500 positive_selection/\n\u2502   \u251c\u2500\u2500 selscan/\n\u2502   \u2502   \u251c\u2500\u2500 {species}/1pop/{ppl}/{method}_{maf}/     # Within-population (iHS, nSL)\n\u2502   \u2502   \u2514\u2500\u2500 {species}/2pop/{pair}/{method}_{maf}/    # Cross-population (XP-EHH, XP-nSL)\n\u2502   \u2514\u2500\u2500 scikit-allel/\n\u2502       \u251c\u2500\u2500 {species}/1pop/{ppl}/{method}/{window}_{step}/   # Negative Tajima's D\n\u2502       \u2514\u2500\u2500 {species}/2pop/{pair}/{method}/{window}_{step}/  # Delta Tajima's D\n\u251c\u2500\u2500 balancing_selection/\n\u2502   \u251c\u2500\u2500 betascan/{species}/{ppl}/m_{core_frq}/\n\u2502   \u2514\u2500\u2500 scikit-allel/{species}/{method}/{ppl}/{window}_{step}/  # Positive Tajima's D\n\u251c\u2500\u2500 dadi/{species}/dfe/{ppl}/\n\u2502   \u251c\u2500\u2500 InferDM/        # Demographic models\n\u2502   \u251c\u2500\u2500 InferDFE/       # DFE inference\n\u2502   \u251c\u2500\u2500 StatDFE/        # Confidence intervals\n\u2502   \u2514\u2500\u2500 plots/          # Fitted model visualizations\n</code></pre>"},{"location":"userguide/output/#understanding-file-paths","title":"Understanding File Paths","text":"<p>Throughout this documentation, file paths use the following wildcards:</p> <ul> <li><code>{species}</code>: Species name (e.g., \"Human\")</li> <li><code>{ppl}</code>: Population code (e.g., \"YRI\")</li> <li><code>{pair}</code>: Population pair (e.g., \"YRI_CHS\")</li> <li><code>{method}</code>: Selection statistic (e.g., \"ihs\", \"windowed_tajima_d\")</li> <li><code>{maf}</code>: Minor allele frequency (e.g., \"0.05\")</li> <li><code>{cutoff}</code>: Top proportion threshold (e.g., \"0.0005\")</li> <li><code>{window}_{step}</code>: Window and step sizes</li> <li><code>{ref_genome}</code>: Reference genome build (e.g., \"hg38\")</li> <li><code>{demog}</code>: Demographic model (e.g., \"two_epoch\")</li> <li><code>{dfe}</code>: DFE model (e.g., \"lognormal\")</li> </ul>"},{"location":"userguide/output/#positive-selection","title":"Positive Selection","text":"<p>Tools for detecting beneficial mutations that have recently increased in frequency:</p>"},{"location":"userguide/output/#selscan","title":"selscan","text":""},{"location":"userguide/output/#within-population-statistics-ihs-nsl","title":"Within-Population Statistics (iHS, nSL)","text":"<p>File path:</p> <pre><code>results/positive_selection/selscan/{species}/1pop/{ppl}/{method}_{maf}/{ppl}.normalized.{method}.maf_{maf}.top_{cutoff}.outliers.scores\n</code></pre> <p>Example output:</p> <pre><code>SNP             CHR     BP      normalized_nsl  abs_normalized_nsl\n21:35702539     21      35702539        -4.88331        4.88331\n20:57138931     20      57138931        4.68161         4.68161\n21:28603177     21      28603177        4.63644         4.63644\n</code></pre> Column Description SNP SNP identifier in format chromosome:position CHR Chromosome number BP Base pair position normalized_{method} Normalized selection statistic (iHS or nSL) abs_normalized_{method} Absolute value of normalized statistic <p>Positive values indicate selection favoring the derived allele, while negative values indicate selection favoring the ancestral allele. High absolute values indicate recent positive selection.</p> <p></p>"},{"location":"userguide/output/#cross-population-statistics-xp-ehh-xp-nsl","title":"Cross-Population Statistics (XP-EHH, XP-nSL)","text":"<p>File path:</p> <pre><code>results/positive_selection/selscan/{species}/2pop/{pair}/{method}_{maf}/{pair}.normalized.{method}.maf_{maf}.top_{cutoff}.outliers.scores\n</code></pre> <p>Same format as within-population statistics.</p> <p>Positive values indicate selection in the first population (e.g., YRI in YRI_CHS), while negative values indicate selection in the second population (e.g., CHS in YRI_CHS).</p> <p>More information: selscan</p>"},{"location":"userguide/output/#scikit-allel","title":"scikit-allel","text":""},{"location":"userguide/output/#windowed-tajimas-d","title":"Windowed Tajima's D","text":"<p>File path:</p> <pre><code>results/positive_selection/scikit-allel/{species}/1pop/{ppl}/windowed_tajima/{window}_{step}/{ppl}.windowed_tajima..top_{cutoff}.outliers.scores\n</code></pre> <p>Example output:</p> <pre><code>SNP             CHR     BP      tajima_d        window_start    window_end      n_snps\n20:61849        20      61849   -0.5400134      61849           161848          215\n20:261849       20      261849  -0.2830888      261849          361848          400\n</code></pre> Column Description SNP SNP identifier in format chromosome:position CHR Chromosome number BP Base pair position (window center) tajima_d Tajima's D statistic window_start Window start position in base pairs window_end Window end position in base pairs n_snps Number of SNPs in window <p>Negative values suggest recent positive selection (selective sweeps), where beneficial alleles rapidly increased in frequency.</p> <p></p> <p>For all Tajima's D methods, each data point in the Manhattan plot represents the starting position (<code>window_start</code>) of a window.</p>"},{"location":"userguide/output/#moving-tajimas-d","title":"Moving Tajima's D","text":"<p>File path:</p> <pre><code>results/positive_selection/scikit-allel/{species}/1pop/{ppl}/moving_tajima_d/{window}_{step}/{ppl}.moving_tajima_d.top_{cutoff}.outliers.scores\n</code></pre> <p>Similar format to windowed approach, but windows are defined by SNP counts rather than base pairs.</p> Column Description SNP SNP identifier in format chromosome:position CHR Chromosome number BP Base pair position (window center) tajima_d Tajima's D statistic window_start Window start position in base pairs window_end Window end position in base pairs n_snps Number of SNPs in window (constant) <p></p>"},{"location":"userguide/output/#delta-tajimas-d-cross-population","title":"Delta Tajima's D (Cross-Population)","text":"<p>File path:</p> <pre><code>results/positive_selection/scikit-allel/{species}/2pop/{pair}/delta_moving_tajima_d/{window}_{step}/{pair}.delta_moving_tajima_d.top_{cutoff}.outliers.scores\n</code></pre> <p>Example output:</p> <pre><code>SNP             CHR     BP      delta_tajima_d  window_start    window_end      n_snps  abs_delta_tajima_d\n21:26659162     21      26659162        3.41144         26659162        26674022        100     3.41144\n21:21456001     21      21456001        3.17360         21456001        21473170        100     3.17360\n21:27242333     21      27242333        -3.07313        27242333        27258823        100     3.07313\n</code></pre> Column Description SNP SNP identifier in format chromosome:position CHR Chromosome number BP Base pair position (window center) delta_tajima_d Difference in Tajima's D between populations window_start Window start position in base pairs window_end Window end position in base pairs n_snps Number of SNPs in window abs_delta_tajima_d Absolute value of delta Tajima's D <p></p> <p>Large positive or negative values indicate selection acting differently between populations.</p> <p>More information: scikit-allel</p>"},{"location":"userguide/output/#balancing-selection","title":"Balancing Selection","text":"<p>Tools for identifying regions where multiple alleles are maintained over time:</p>"},{"location":"userguide/output/#betascan","title":"BetaScan","text":"<p>File path:</p> <pre><code>results/balancing_selection/betascan/{species}/{ppl}/m_{core_frq}/{ppl}.{ref_genome}.m_{core_frq}.b1.top_{cutoff}.outliers.scores\n</code></pre> <p>Example output:</p> <pre><code>SNP             CHR     BP      B1\n20:1914695      20      1914695 41.939494\n20:1914712      20      1914712 41.479453\n20:1914729      20      1914729 40.555049\n</code></pre> Column Description SNP SNP identifier in format chromosome:position CHR Chromosome number BP Base pair position B1 Beta1 statistic for balancing selection <p>Higher B1 values indicate stronger evidence for long-term balancing selection, where multiple alleles are maintained over extended periods.</p> <p></p> <p>More information: BetaScan</p>"},{"location":"userguide/output/#scikit-allel_1","title":"scikit-allel","text":""},{"location":"userguide/output/#windowed-tajimas-d_1","title":"Windowed Tajima's D","text":"<p>File path:</p> <pre><code>results/balancing_selection/scikit-allel/{species}/windowed_tajima_d/{ppl}/{window}_{step}/{ppl}.windowed_tajima_d.top_{cutoff}.outliers.scores\n</code></pre> <p>Example output:</p> <pre><code>SNP             CHR     BP      tajima_d        window_start    window_end      n_snps\n20:61849        20      61849   -0.5400134      61849           161848          215\n20:261849       20      261849  -0.2830888      261849          361848          400\n</code></pre> Column Description SNP SNP identifier in format chromosome:position CHR Chromosome number BP Base pair position (window center) tajima_d Tajima's D statistic window_start Window start position in base pairs window_end Window end position in base pairs n_snps Number of SNPs in window <p>Positive values indicate balancing selection, where multiple alleles are maintained in the population.</p>"},{"location":"userguide/output/#moving-tajimas-d_1","title":"Moving Tajima's D","text":"<p>File path: </p> <pre><code>results/balancing_selection/scikit-allel/{species}/moving_tajima_d/{window}_{step}/{ppl}.moving_tajima_d.top_{cutoff}.outliers.scores\n</code></pre> <p>Similar format to windowed approach, but windows are defined by SNP counts rather than base pairs.</p> Column Description SNP SNP identifier in format chromosome:position CHR Chromosome number BP Base pair position (window center) tajima_d Tajima's D statistic window_start Window start position in base pairs window_end Window end position in base pairs n_snps Number of SNPs in window (constant)"},{"location":"userguide/output/#distribution-of-fitness-effects","title":"Distribution of Fitness Effects","text":"<p>Inference of mutation fitness distributions across selection strength categories:</p>"},{"location":"userguide/output/#dadidadi-cli","title":"dadi/dadi-cli","text":""},{"location":"userguide/output/#demographic-model-inference","title":"Demographic Model Inference","text":"<p>File path: <code>results/dadi/{species}/dfe/{ppl}/InferDM/{ppl}.{ref_genome}.{demog}.InferDM.bestfits</code></p> <p>Example output:</p> <pre><code># Log(likelihood)       nu      T       misid   theta\n-29.738235902874877     3.2402258068957983      0.13580062396208237     0.0010470465761291449   321.237660524018\n-29.73823629293304      3.2417998728753408      0.13578140459967458     0.0010576355371547388   321.23238379628344\n-29.73823658527745      3.237659010918116       0.13591524984020853     0.0010605026099018222   321.22253191565875\n</code></pre> Column Description Log(likelihood) Log-likelihood of the model fit (higher is better) nu Ratio of current population size to ancestral population size T Time since population size change, measured in 2Ne generations misid Proportion of misidentified ancestral states theta Population-scaled mutation rate (4Ne\u03bc)"},{"location":"userguide/output/#demographic-model-fit","title":"Demographic Model Fit","text":"<p>File path: <code>results/dadi/{species}/dfe/{ppl}/plots/{ppl}.{ref_genome}.{demog}.fitted.png</code></p> <p></p> <p>The visualization shows the observed frequency spectrum (data) compared to the model-predicted spectrum.</p>"},{"location":"userguide/output/#distribution-of-fitness-effects_1","title":"Distribution of Fitness Effects","text":"<p>File path: <code>results/dadi/{species}/dfe/{ppl}/InferDFE/{ppl}.{ref_genome}.{demog}.{dfe}.InferDFE.bestfits</code></p> <p>Example output:</p> <pre><code># Log(likelihood)       log_mu  log_sigma       misid   theta\n-28.737041385073574     2.5282728150148785      4.591179583286655       0.039371652920637594    742.0589958104816\n-28.73804138508753      2.5282735377291865      4.591183662610013       0.0393715391668421      742.0589958104816\n-28.737041388380618     2.5283038170363823      4.5912804442420105      0.039370931031321235    742.0589958104816\n</code></pre> Column Description Log(likelihood) Log-likelihood of the DFE model fit (higher is better) log_mu Mean of log-normal distribution of selection coefficients log_sigma Standard deviation of log-normal distribution of selection coefficients misid Proportion of misidentified ancestral states theta Population-scaled mutation rate (4Ne\u03bc)"},{"location":"userguide/output/#dfe-model-fit-plot","title":"DFE Model Fit Plot","text":"<p>File path: <code>results/dadi/{species}/dfe/{ppl}/plots/{ppl}.{ref_genome}.{demog}.{dfe}.fitted.png</code></p> <p> The visualization shows the observed vs. model-predicted frequency spectrum for nonsynonymous mutations.</p>"},{"location":"userguide/output/#mutation-proportion-plot","title":"Mutation Proportion Plot","text":"<p>File path: <code>results/dadi/{species}/dfe/{ppl}/plots/{ppl}.{ref_genome}.{demog}.{dfe}.fitted.mut.prop.png</code></p> <p></p> <p>The mutation proportion plot shows the distribution of mutations by selection strength (2N|s|): nearly neutral mutations (&lt; 1), weakly deleterious mutations (1\u201310), moderately deleterious mutations (10\u2013100), and strongly deleterious mutations (&gt; 100).</p> <p>#### Confidence Intervals</p> <p>File path: <code>results/dadi/{species}/dfe/{ppl}/StatDFE/{ppl}.{ref_genome}.{demog}.{dfe}.godambe.ci</code></p> <p>Example output:</p> <pre><code>Estimated 95% uncerts (theta adj), with step size 0.1): [2.45625971 3.17513531 0.11405905]\nLower bounds of 95% confidence interval : [-0.65471712 -0.74208004 -0.0046111 ]\nUpper bounds of 95% confidence interval : [4.2578023  5.60819059 0.22350701]\n\nEstimated 95% uncerts (theta adj), with step size 0.01): [2.19800876 2.55236006 0.10687941]\nLower bounds of 95% confidence interval : [-0.39646617 -0.11930478  0.00256854]\nUpper bounds of 95% confidence interval : [3.99955135 4.98541534 0.21632737]\n\nEstimated 95% uncerts (theta adj), with step size 0.001): [2.19575422 2.54701563 0.10682199]\nLower bounds of 95% confidence interval : [-0.39421163 -0.11396035  0.00262596]\nUpper bounds of 95% confidence interval : [3.99729681 4.98007091 0.21626994]\n</code></pre> <p>Bootstrap-based 95% confidence intervals for all DFE parameters.</p> <p>More information: dadi-cli</p>"},{"location":"userguide/output/#functional-annotation","title":"Functional Annotation","text":"<p>Gene and functional annotation of selection outliers:</p>"},{"location":"userguide/output/#annovar-annotated-outliers","title":"ANNOVAR Annotated Outliers","text":"<p>All selection outliers are annotated with gene information:</p> <p>File path: <code>{analysis_path}/{file_prefix}.annotated.outliers</code></p> <p>Example output:</p> <pre><code>Chr     Start   End     Ref     Alt     Func.refGene    Gene.refGene    ExonicFunc.refGene      AAChange.refGene\n20      14150039        14150039        C       A       intronic        MACROD2 .       .\n20      17148100        17148100        C       A       intergenic      OTOR;PCSK2      .       .\n20      23595497        23595497        G       A       intergenic      CST9L;CST9      .       .\n</code></pre> Column Description Chr Chromosome number Start Variant start position in base pairs End Variant end position in base pairs Ref Reference allele Alt Alternative allele Func.refGene Functional region (exonic, intronic, intergenic, UTR, etc.) Gene.refGene Gene symbol(s) ExonicFunc.refGene Exonic function (synonymous, nonsynonymous, stopgain, stoploss, etc.) AAChange.refGene Amino acid change for coding variants"},{"location":"userguide/output/#outlier-gene-lists","title":"Outlier Gene Lists","text":"<p>File path: <code>{analysis_path}/{file_prefix}.outlier.genes</code></p> <p>Example output:</p> <pre><code>Gene\nHLCS\nMACROD2\nPCSK2\nUQCC1\n</code></pre> <p>Simple list of unique genes extracted from annotated outliers.</p> <p>More information: ANNOVAR</p>"},{"location":"userguide/output/#go-enrichment-analysis","title":"GO Enrichment Analysis","text":"<p>Statistical testing for enrichment of biological processes in candidate genes:</p>"},{"location":"userguide/output/#gowinda-enrichment-results","title":"Gowinda Enrichment Results","text":"<p>File path: <code>{analysis_path}/{file_prefix}.gowinda.enrichment.tsv</code></p> <p>Example output:</p> <pre><code>GO_ID       avg_genes_sim   genes_found     p_value         p_adjusted      genes_uniq      genes_max       genes_total     description                     gene_list\nGO:0034551  0.008           1               0.0082240000    1.0000000000    1               1               14              mitochondrial complex III       uqcc1\nGO:0031410  0.270           2               0.0247750000    1.0000000000    2               37              1017            cytoplasmic vesicle             uqcc1,pcsk2\nGO:0004077  0.030           1               0.0297130000    1.0000000000    1               1               1               biotin ligase activity          hlcs\n</code></pre> Column Description GO_ID Gene Ontology term identifier avg_genes_sim Average number of genes in simulations genes_found Number of outlier genes found in this GO term p_value Uncorrected p-value from simulation p_adjusted FDR-corrected p-value genes_uniq Number of unique genes in this GO term genes_max Maximum possible genes for this term genes_total Total genes in background set description GO term description gene_list Comma-separated list of outlier genes"},{"location":"userguide/output/#enrichment-visualization","title":"Enrichment Visualization","text":"<p>File path: <code>{analysis_path}/{file_prefix}.gowinda.enrichment.png</code></p> <p></p> <p>The enrichment plot shows top 20 GO terms, sorted by their significance (FDR adjusted p-value) and then by the number of genes found. Bars are colored based on significance: red for highly significant enrichment (&lt; 0.001), purple for significant enrichment (&lt; 0.01), blue for moderately significant enrichment (&lt; 0.05), and gray for non-significant results (\u2265 0.05).</p> <p>More information: Gowinda Tutorial</p>"},{"location":"userguide/output/#interactive-html-reports","title":"Interactive HTML Reports","text":"<p>All methods generate interactive HTML tables with search, sort, and export functionality:</p> <ul> <li>Gene lists: <code>{analysis_path}/{file_prefix}.outlier.genes.html</code></li> <li>Enrichment results: <code>{analysis_path}/{file_prefix}.gowinda.enrichment.html</code></li> <li> <p>Best-fit parameters:</p> </li> <li> <p><code>results/dadi/{species}/dfe/{ppl}/html/{ppl}.{ref_genome}.{demog}.InferDM.top10.bestfits.html</code></p> </li> <li><code>results/dadi/{species}/dfe/{ppl}/html/{ppl}.{ref_genome}.{demog}.{dfe}.InferDFE.top10.bestfits.html</code></li> <li><code>results/dadi/{species}/dfe/{ppl}/html/{ppl}.{ref_genome}.{demog}.{dfe}.godambe.ci.html</code></li> </ul>"},{"location":"userguide/usage/","title":"Usage","text":"<p><code>selscape</code> provides example data to test the workflow, and supports analyzing your own datasets with flexible configuration.</p>"},{"location":"userguide/usage/#quick-start-with-example-data","title":"Quick Start with Example Data","text":""},{"location":"userguide/usage/#1-download-example-data","title":"1. Download Example Data","text":"<p><code>selscape</code> includes a workflow to download example data from the 1000 Genomes Project:</p> <pre><code># Download example data (YRI and CHS populations, chromosomes 20-21)\nsnakemake -s examples/get_example_data.smk -c 1\n</code></pre> <p>This creates the following structure:</p> <pre><code>examples/data/Human/\n\u251c\u2500\u2500 raw/\n\u2502   \u251c\u2500\u2500 full_chr20.vcf.gz\n\u2502   \u251c\u2500\u2500 full_chr20.vcf.gz.tbi\n\u2502   \u251c\u2500\u2500 full_chr21.vcf.gz\n\u2502   \u2514\u2500\u2500 full_chr21.vcf.gz.tbi\n\u251c\u2500\u2500 ancestral_alleles/\n\u2502   \u2514\u2500\u2500 homo_sapiens_ancestor_GRCh38/\n\u251c\u2500\u2500 repeats/\n\u2502   \u251c\u2500\u2500 hg38.rmsk.autosomes.bed\n\u2502   \u251c\u2500\u2500 hg38.seg.dups.autosomes.bed\n\u2502   \u2514\u2500\u2500 hg38.simple.repeats.autosomes.bed\n\u251c\u2500\u2500 annotation/\n\u2502   \u251c\u2500\u2500 Human.gtf.gz\n\u2502   \u2514\u2500\u2500 gene2go.gz\n\u2514\u2500\u2500 metadata/\n    \u2514\u2500\u2500 example_metadata.txt\n</code></pre>"},{"location":"userguide/usage/#2-run-analysis-on-example-data","title":"2. Run Analysis on Example Data","text":"<pre><code># Local execution (single core)\nsnakemake -c 1 --configfile config/main.yaml\n\n# Local execution (multiple cores)\nsnakemake -c 4 --configfile config/main.yaml\n\n# HPC cluster (SLURM)\nsnakemake -c 1 --configfile config/main.yaml --profile config/slurm/ -j 50\n</code></pre>"},{"location":"userguide/usage/#analyzing-your-own-data","title":"Analyzing Your Own Data","text":""},{"location":"userguide/usage/#1-prepare-your-data","title":"1. Prepare Your Data","text":""},{"location":"userguide/usage/#vcf-files","title":"VCF Files","text":"<p>Organize your VCF files according to your chosen naming scheme. The configuration will tell Selscape how to find them.</p> <p>Example structures:</p> <pre><code># Option 1: Chromosome in filename\nresources/data/\n\u251c\u2500\u2500 chr1.vcf.gz\n\u251c\u2500\u2500 chr1.vcf.gz.tbi\n\u251c\u2500\u2500 chr2.vcf.gz\n\u2514\u2500\u2500 chr2.vcf.gz.tbi\n\n# Option 2: Prefix + chromosome\nresources/data/\n\u251c\u2500\u2500 Sample_chr1.vcf.gz\n\u251c\u2500\u2500 Sample_chr1.vcf.gz.tbi\n\u251c\u2500\u2500 Sample_chr2.vcf.gz\n\u2514\u2500\u2500 Sample_chr2.vcf.gz.tbi\n</code></pre> <p>Requirements: - All VCF files must be bgzipped (<code>.vcf.gz</code>) - All VCF files must be indexed (<code>.vcf.gz.tbi</code>) - Biallelic SNPs only (can be filtered by selscape)</p>"},{"location":"userguide/usage/#metadata-file","title":"Metadata File","text":"<p>Create a tab-separated file mapping samples to populations:</p> <pre><code>Sample  Population\nNA19001 YRI\nNA19002 YRI\nNA19003 YRI\nHG00419 CHS\nHG00420 CHS\nHG00421 CHS\n</code></pre> <p>Requirements: - Header line: <code>Sample</code> and <code>Population</code> - Tab-separated - Sample IDs must match VCF file samples</p>"},{"location":"userguide/usage/#ancestral-alleles-optional","title":"Ancestral Alleles (Optional)","text":"<p>If available, ancestral alleles enable polarized analyses (selscan, unfolded BetaScan/dadi):</p> <pre><code>ancestral_alleles/\n\u251c\u2500\u2500 anc_chr1.bed.gz\n\u251c\u2500\u2500 anc_chr1.bed.gz.tbi\n\u251c\u2500\u2500 anc_chr2.bed.gz\n\u2514\u2500\u2500 anc_chr2.bed.gz.tbi\n</code></pre> <p>Format: BED file with ancestral base in 4th column:</p> <pre><code>chr1    0   1   A\nchr1    1   2   C\nchr1    2   3   G\n</code></pre>"},{"location":"userguide/usage/#2-configure-analysis","title":"2. Configure Analysis","text":"<p>Edit <code>config/main.yaml</code>:</p> <pre><code># Species identification\nspecies: \"YourSpecies\"\ntax_id: 9606  # Update for your species\nref_genome: \"your_ref\"\nploidy: 2\n\n# Populations to analyze\npopulations:\n  - Pop1\n  - Pop2\n\n# VCF file configuration - ADJUST TO YOUR NAMING SCHEME\ndata_folder: \"resources/data\"\nvcf_prefix: \"chr\"  # or \"Sample_chr\", \"full_chr\", etc.\nvcf_suffix: \".vcf.gz\"\n\n# Sample metadata\nmetadata: \"resources/metadata/samples.txt\"\n\n# Chromosomes to analyze\nchromosomes:\n  - 1\n  - 2\n  - 3\n  # ... add all chromosomes\n\n# Ancestral alleles (optional)\nanc_alleles:\n  path: \"resources/ancestral_alleles\"\n  prefix: \"anc_chr\"\n\n# Annotation files\ngenome_annotation: \"resources/annotation/genome.gtf.gz\"\ngene2go: \"resources/annotation/gene2go.gz\"\n\n# Repeat regions (optional but recommended)\nrmsk: \"resources/repeats/repeats.bed\"\nseg_dup: \"resources/repeats/seg_dups.bed\"\nsim_rep: \"resources/repeats/simple_repeats.bed\"\n\n# Analysis tool configuration\nselscan_config: \"config/selscan.yaml\"\nbetascan_config: \"config/betascan.yaml\"\ndadi_config: \"config/dadi-cli.yaml\"\nscikit_allel_config: \"config/scikit-allel.yaml\"\n</code></pre>"},{"location":"userguide/usage/#3-run-analysis","title":"3. Run Analysis","text":"<pre><code># Preview what will be executed (dry run)\nsnakemake -np --configfile /path/to/your/main.yaml\n\n# Local execution\nsnakemake -c 1 --configfile /path/to/your/main.yaml\n\n# HPC cluster (SLURM)\nsnakemake -c 1 --configfile /path/to/your/main.yaml --profile config/slurm/ --j 50\n</code></pre>"},{"location":"userguide/usage/#running-specific-analyses","title":"Running Specific Analyses","text":"<p>You can run only specific methods by requesting specific output files:</p> <pre><code># Only BetaScan\nsnakemake -c 1 \\\n  results/balancing_selection/betascan/Human/YRI/m_0.15/YRI.hg38.m_0.15.b1.top_0.0005.scores.png\n\n# Only selscan (requires ancestral alleles)\nsnakemake -c 1 \\\n  results/positive_selection/selscan/Human/1pop/YRI/ihs_0.05/YRI.normalized.ihs.maf_0.05.top_0.0005.scores.png\n\n# Only scikit-allel\nsnakemake -c 1 \\\n  results/positive_selection/scikit-allel/Human/1pop/YRI/windowed_tajima_d/100000_1/YRI.windowed_tajima_d.top_0.05.scores.png\n\n# Only dadi-cli\nsnakemake -c 1 \\\n  results/dadi/Human/dfe/YRI/plots/YRI.hg38.two_epoch.lognormal.fitted.png\n</code></pre>"},{"location":"userguide/usage/#generate-html-report","title":"Generate HTML Report","text":"<p>Snakemake can automatically generate an interactive HTML report with main results, plots, and tables:</p> <pre><code># Generate report after workflow completion\nsnakemake --report --configfile /path/to/your/main.yaml\n\n# Customize report location and file name\nsnakemake --report /path/to/my_report.html --configfile /path/to/your/main.yaml\n</code></pre>"},{"location":"userguide/usage/#clean-restart","title":"Clean Restart","text":"<p>To remove all results and start fresh:</p> <pre><code># Remove all results (keeps raw data)\nrm -rf results/ logs/\n\n# Remove everything including downloaded data\nrm -rf resources/ results/ logs/\n</code></pre>"},{"location":"userguide/usage/#workflow-options","title":"Workflow Options","text":"Command Purpose <code>-c 1</code> or <code>--cores 1</code> Use 1 core (safest for testing) <code>-c 4</code> Use 4 parallel jobs (local) <code>-j or --jobs 50</code> Submit up to 50 jobs (cluster) <code>--profile config/slurm/</code> Use SLURM cluster configuration <code>-n</code> or <code>--dry-run</code> Preview what will be executed <code>-p</code> Print shell commands <code>--forceall</code> Re-run all steps <code>--unlock</code> Unlock working directory after crash"},{"location":"userguide/usage/#troubleshooting","title":"Troubleshooting","text":"<p>Workflow locked:</p> <pre><code>snakemake --unlock\n</code></pre> <p>Re-run specific rule:</p> <pre><code>snakemake --forcerun &lt;rule_name&gt; -c 1\n</code></pre> <p>Check what will run:</p> <pre><code>snakemake -n -p\n</code></pre> <p>For more information, visit the Snakemake documentation.</p>"}]}